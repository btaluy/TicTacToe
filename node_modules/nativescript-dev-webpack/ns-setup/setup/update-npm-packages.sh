#!/bin/bash

if (npm -v | grep -q 4.); then
	npm cache clean || true
else
	npm cache clean --force || true
fi

rm -rf ~/.npm/tns-* && true

npm uninstall -g npm-check-updates && true
npm install -g npm-check-updates

npm uninstall -g gulp-cli && true
npm install -g gulp-cli

npm uninstall -g grunt-cli && true
npm install -g grunt-cli

cp /tns-dist/CLI/Stable/nativescript.tgz .
npm uninstall -g nativescript && true
npm install -g nativescript.tgz --ignore-scripts
tns usage-reporting disable
tns error-reporting disable

if [[ "$OSTYPE" == "darwin"* ]]; then
    npm uninstall -g ios-deploy && true
    npm install -g ios-deploy
fi

npm uninstall -g appium && true
npm install -g appium@1.7.2
